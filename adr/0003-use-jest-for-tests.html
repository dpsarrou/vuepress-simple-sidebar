<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>3. Use Jest for automated tests | vuepress-simple-sidebar</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <link rel="preload" href="/vuepress-simple-sidebar/assets/css/0.styles.7bb1683b.css" as="style"><link rel="preload" href="/vuepress-simple-sidebar/assets/js/app.472de899.js" as="script"><link rel="preload" href="/vuepress-simple-sidebar/assets/js/2.a87429f3.js" as="script"><link rel="preload" href="/vuepress-simple-sidebar/assets/js/8.1991946f.js" as="script"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/10.60441c1b.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/11.e5e0900a.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/12.90c08af9.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/13.e2606cfe.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/14.22ec2556.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/15.cf215300.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/16.fccc6c42.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/17.83f5ba76.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/18.8fe1d975.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/19.cdd81a2f.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/20.d6a2e5ef.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/21.c9e64543.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/22.424a0392.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/23.78e59d8d.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/24.345f8ce1.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/25.ff7d6582.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/26.c7e5e7b6.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/27.35ba6f60.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/28.9acbee04.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/3.1b9b5c76.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/4.7d5f245c.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/5.d029c308.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/6.6a20be92.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/7.d914af7d.js"><link rel="prefetch" href="/vuepress-simple-sidebar/assets/js/9.19aa7088.js">
    <link rel="stylesheet" href="/vuepress-simple-sidebar/assets/css/0.styles.7bb1683b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-simple-sidebar/" class="home-link router-link-active"><!----> <span class="site-name">vuepress-simple-sidebar</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Adr</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-simple-sidebar/adr/" aria-current="page" class="sidebar-link">Overview</a></li><li><a href="/vuepress-simple-sidebar/adr/0001-record-architecture-decisions.html" class="sidebar-link">1. Record architecture decisions</a></li><li><a href="/vuepress-simple-sidebar/adr/0002-use-typescript.html" class="sidebar-link">2. Use typescript to develop the plugin</a></li><li><a href="/vuepress-simple-sidebar/adr/0003-use-jest-for-tests.html" aria-current="page" class="active sidebar-link">3. Use Jest for automated tests</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-simple-sidebar/adr/0003-use-jest-for-tests.html#status" class="sidebar-link">Status</a></li><li class="sidebar-sub-header"><a href="/vuepress-simple-sidebar/adr/0003-use-jest-for-tests.html#context" class="sidebar-link">Context</a></li><li class="sidebar-sub-header"><a href="/vuepress-simple-sidebar/adr/0003-use-jest-for-tests.html#decision" class="sidebar-link">Decision</a></li><li class="sidebar-sub-header"><a href="/vuepress-simple-sidebar/adr/0003-use-jest-for-tests.html#consequences" class="sidebar-link">Consequences</a></li></ul></li><li><a href="/vuepress-simple-sidebar/adr/0004-use-map-class-for-tree.html" class="sidebar-link">4. Use ES6 Map class for storing the path tree</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_3-use-jest-for-automated-tests"><a href="#_3-use-jest-for-automated-tests" class="header-anchor">#</a> 3. Use Jest for automated tests</h1> <p>Date: 2020-06-01</p> <h2 id="status"><a href="#status" class="header-anchor">#</a> Status</h2> <p>Accepted</p> <h2 id="context"><a href="#context" class="header-anchor">#</a> Context</h2> <p>Automated testing is by now a standard in every quality software develpment process.
The benefits are many, productivity increase, time saving, better quality.
Specifically for this plugin, there are many checkpoints that have to be verified on
each code change, including but not limited to:</p> <ul><li>Does the code work as its supposed to do after the change? Maybe the generated
paths are not correct any more or even empty? Did we miss a trailing slash
somewhere?</li> <li>Does the plugin even work with the given input of the Vuepress framework? Maybe
when given a Page with no title, it breaks?</li> <li>Does the plugin even work when included in Vuepress? Does Vuepress build process
finish successfully when the plugin is included?</li></ul> <p>The above require a manual testing process, <strong>for each code change</strong>.</p> <p>From the many javascript testing frameworks, <a href="https://jestjs.io/" target="_blank" rel="noopener noreferrer">Jest<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> is one
of the most popular ones (for example its the default test framework to use with <code>React</code>)
that can automate the above tasks. It supports writing very simple tests, in
javascript but also typescript through <code>ts-jest</code>.</p> <h2 id="decision"><a href="#decision" class="header-anchor">#</a> Decision</h2> <p>We will use <code>Jest</code> as the testing framework.</p> <h2 id="consequences"><a href="#consequences" class="header-anchor">#</a> Consequences</h2> <ul><li>The developed codebase will be accompanied by automated tests</li> <li>Before every commit or PR, the tests need to pass successfully</li> <li>The code must be tested to the fullest extend: strive for 100% coverage as much
as possible.</li></ul> <p>Install <code>jest</code>, <code>ts-jest</code> and its types with</p> <div class="language- extra-class"><pre><code>npm install --save-dev jest ts-jest @types/jest
</code></pre></div><p>Use the key <code>jest</code> in <a href="./../../../package.json">package.json</a> to configure the
framework. Note that when typescript is used to write the tests, for the IDE
autocomplete features to work, the test files path needs to be included in
the include paths of typescript in <code>tsconfig.json</code>. However this will have
the test folder and all its files be included in the production-ready
compiled files which is not what is usually needed. To acccount for this,
create an additional <code>tsconfig.json</code> file in the <a href="./../../../../tests">tests/</a>
folder which extends the main <code>tsconfig.json</code> file but ignores the output of
that folder. See this <a href="https://stackoverflow.com/questions/54139158/cannot-find-name-describe-do-you-need-to-install-type-definitions-for-a-test" target="_blank" rel="noopener noreferrer">link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
for more details.</p> <p>Two types of test suites are identified as of now:</p> <ul><li><p>A unit test suite will verify that the classes of the plugin work as expected
when given specific input, and provide the expected output. To run them use</p> <div class="language- extra-class"><pre><code>npm run test:unit
</code></pre></div></li> <li><p>An integration suite will verify that Vuepress build process completes
successfully when the plugin is used. To</p> <div class="language- extra-class"><pre><code>npm run test:integration
</code></pre></div></li></ul> <p>To run all tests instead use</p> <div class="language- extra-class"><pre><code>npm run test
</code></pre></div><p>And to run all tests (or each test suite) in <code>watch</code> for changes mode use the
<code>--watch</code> flag as for example</p> <div class="language- extra-class"><pre><code>npm run test:unit -- --watch
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vuepress-simple-sidebar/adr/0002-use-typescript.html" class="prev">
        2. Use typescript to develop the plugin
      </a></span> <span class="next"><a href="/vuepress-simple-sidebar/adr/0004-use-map-class-for-tree.html">
        4. Use ES6 Map class for storing the path tree
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-simple-sidebar/assets/js/app.472de899.js" defer></script><script src="/vuepress-simple-sidebar/assets/js/2.a87429f3.js" defer></script><script src="/vuepress-simple-sidebar/assets/js/8.1991946f.js" defer></script>
  </body>
</html>
